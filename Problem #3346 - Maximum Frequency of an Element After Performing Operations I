from collections import Counter
class Solution:
    def maxFrequency(self, nums: List[int], k: int, numOperations: int) -> int:
        if len(nums)==1:
            return 1
        dic=Counter(nums)
        if k==0:
            return max(dic.values())
        lcurfqc=0
        rcurfqc=0
        maxfqc=0
        l=min(nums)
        r=max(nums)
        for i in range(l-k,l):
            if i in dic:
                lcurfqc+=dic[i]
        for i in range(l,l+k+1):
            if i in dic:
                rcurfqc+=dic[i]
        for i in range(l,r+1):
            if i-k-1 in dic:
                lcurfqc-=dic[i-k-1]
            if i-1 in dic:
                lcurfqc+=dic[i-1]
            if i in dic:
                rcurfqc-=dic[i]
            if i+k in dic and i>l:
                rcurfqc+=dic[i+k]
            if i in dic:
                if min(lcurfqc+rcurfqc,numOperations)+dic[i]>maxfqc:
                    maxfqc=min(lcurfqc+rcurfqc,numOperations)+dic[i]
            else:
                if min(lcurfqc+rcurfqc,numOperations)>maxfqc:
                    maxfqc=min(lcurfqc+rcurfqc,numOperations)
            
            
            
        return maxfqc
